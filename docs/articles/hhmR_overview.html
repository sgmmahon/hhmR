<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="hhmR">
<title>Hierarchical Heatmaps (hhmR) Vignette • hhmR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Hierarchical Heatmaps (hhmR) Vignette">
<meta property="og:description" content="hhmR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">hhmR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/hhmR_overview.html">Hierarchical Heatmaps (hhmR) Vignette</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sgmmahon/hhmR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Hierarchical Heatmaps (hhmR) Vignette</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/sgmmahon/hhmR/blob/HEAD/vignettes/hhmR_overview.Rmd" class="external-link"><code>vignettes/hhmR_overview.Rmd</code></a></small>
      <div class="d-none name"><code>hhmR_overview.Rmd</code></div>
    </div>

    
    
<p><br></p>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p><code>hhmR</code> allows users to create high-quality heatmaps from
labelled, hierarchical data. Specifically, for data with a two-level
hierarchical structure, it will produce a heatmap where each row and
column represents a category at the lower level. These rows and columns
are then grouped by the higher-level group each category belongs to,
with the names for each category and groups shown in the margins. While
other packages (e.g. <code>dendextend</code>) allow heatmap rows and
columns to be arranged by groups, I believe this is the only R package
which also labels the data at both levels - i.e. both category and group
names are shown along the left and bottom margins.</p>
<p><br></p>
</div>
<div class="section level2">
<h2 id="hierarchical-heatmaps-hhm">Hierarchical Heatmaps (<code>hhm</code>)<a class="anchor" aria-label="anchor" href="#hierarchical-heatmaps-hhm"></a>
</h2>
<p>The main function within the package is <code>hhm</code>. This
function is useful if you wish to create a heatmap where the categories
shown on both the x and y axis can be grouped in some way. This heatmap
will order the categories by their assigned group and present both the
categories and group labels along the axes. To illustrate how this
function can be used, we use internal migration data from a fake country
(<code>example_migration</code>). This country is made up of regions,
with each region containing multiple counties. This hierachical
structure is summarised below:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Import dplyr for data cleaning</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summarise hierarchical data structure</span></span>
<span><span class="va">example_migration</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">`Origin Region`</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>                      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reframe.html" class="external-link">reframe</a></span><span class="op">(</span>`Origin County` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">`Origin County`</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Region"</span>,<span class="st">"County"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 18 × 2</span></span></span>
<span><span class="co">#&gt;    Region     County     </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Midlands   Silverlake </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Midlands   Thornbury  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Midlands   Maplewood  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Midlands   Hawthorne  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Midlands   Pinehurst  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> North      Greenridge </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> North      Windermoor </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> North      Bramblewood</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> South East Stonebridge</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> South East Brookfield </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> South East Ashford    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> South East Glenville  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> South East Sunnyvale  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> South East Westfield  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> South West Riverton   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> South West Meadowbrook</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> South West Fairhaven  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> South West Oakdale</span></span></code></pre></div>
<p>This dataset contains information on the number of people that have
moved between these counties / regions over a given period of time. It
contains five columns: an <code>Origin County</code> (and the
<code>Origin Region</code> it is within), a
<code>Destination County</code> (and the <code>Destination Region</code>
it is within), and the number of people who have migrated between the
origin and destination counties during the observation period
(<code>Migration</code>).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Show data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">example_migration</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Origin County Destination County Origin Region Destination Region Migration</span></span>
<span><span class="co">#&gt; 1    Greenridge         Greenridge         North              North       420</span></span>
<span><span class="co">#&gt; 2    Windermoor         Greenridge         North              North        28</span></span>
<span><span class="co">#&gt; 3   Bramblewood         Greenridge         North              North        28</span></span>
<span><span class="co">#&gt; 4    Silverlake         Greenridge      Midlands              North        37</span></span>
<span><span class="co">#&gt; 5     Thornbury         Greenridge      Midlands              North        27</span></span>
<span><span class="co">#&gt; 6     Maplewood         Greenridge      Midlands              North        35</span></span></code></pre></div>
<div class="section level4">
<h4 id="initial-heatmap">Initial Heatmap<a class="anchor" aria-label="anchor" href="#initial-heatmap"></a>
</h4>
<p>A useful way of visualising migration data is using a migration
matrix or heatmap. However, as this data is hierarchical, it would also
be useful to show how migrants have moved between regions within the
same figure. This is where the <code>hhm</code> function can be useful.
It can create a heatmap which shows the number of migrants that have
moved between the different counties, with the rows and columns ordered
and labelled by region.</p>
<p>To run the function, <code>Origin County</code> and
<code>Destination County</code> are provided as lower-level categories
to be shown along the y and x axes respectively
(i.e. <code>ylower</code> and <code>xlower</code>). Additionally,
<code>Origin Region</code> and <code>Destination Region</code> are
provided as upper-level groups via which the rows and columns are
ordered (i.e. <code>yupper</code> and <code>xupper</code>). Finally,
<code>Migration</code> provides the values with which to populate the
heatmap, while <code>yttl_width</code> and <code>xttl_height</code> are
used to ensure there is enough space for the region names to be shown
correctly.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create Intial heatmap</span></span>
<span><span class="va">hierarchical_heatmap</span> <span class="op">=</span> <span class="fu"><a href="../reference/hhm.html">hhm</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">example_migration</span>,</span>
<span>                           ylower <span class="op">=</span> <span class="st">"Origin County"</span>,</span>
<span>                           xlower <span class="op">=</span> <span class="st">"Destination County"</span>,</span>
<span>                           yupper <span class="op">=</span> <span class="st">"Origin Region"</span>,</span>
<span>                           xupper <span class="op">=</span> <span class="st">"Destination Region"</span>,</span>
<span>                           values <span class="op">=</span> <span class="st">"Migration"</span>,</span>
<span>                           yttl_width <span class="op">=</span> <span class="fl">0.22</span>,</span>
<span>                           xttl_height <span class="op">=</span> <span class="fl">0.22</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View result</span></span>
<span><span class="va">hierarchical_heatmap</span></span></code></pre></div>
<p><img src="hhmR_overview_files/figure-html/unnamed-chunk-5-1.png" width="686.4"></p>
</div>
<div class="section level4">
<h4 id="remove-diagonal">Remove diagonal<a class="anchor" aria-label="anchor" href="#remove-diagonal"></a>
</h4>
<p>In the above example, the darkest colours are all shown along the
diagonal. This is because, across a given period of time, the majority
of the population does not migrate, meaning their origin and destination
counties are the same. In order to focus on people who moved between
different counties, we can remove the diagonal by setting
<code>rm_diag</code> to <code>TRUE</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Remove diagonal from heatmap (i.e. hide static populations)</span></span>
<span><span class="va">removed_diag</span>         <span class="op">=</span> <span class="fu"><a href="../reference/hhm.html">hhm</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">example_migration</span>,</span>
<span>                           ylower <span class="op">=</span> <span class="st">"Origin County"</span>,</span>
<span>                           xlower <span class="op">=</span> <span class="st">"Destination County"</span>,</span>
<span>                           yupper <span class="op">=</span> <span class="st">"Origin Region"</span>,</span>
<span>                           xupper <span class="op">=</span> <span class="st">"Destination Region"</span>,</span>
<span>                           values <span class="op">=</span> <span class="st">"Migration"</span>,</span>
<span>                           yttl_width <span class="op">=</span> <span class="fl">0.22</span>,</span>
<span>                           xttl_height <span class="op">=</span> <span class="fl">0.22</span>,</span>
<span>                           rm_diag <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View result</span></span>
<span><span class="va">removed_diag</span></span></code></pre></div>
<p><img src="hhmR_overview_files/figure-html/unnamed-chunk-6-1.png" width="686.4"></p>
</div>
<div class="section level4">
<h4 id="normalise-legend">Normalise legend<a class="anchor" aria-label="anchor" href="#normalise-legend"></a>
</h4>
<p>Sometimes it can be useful to normalise the values within a heatmap,
so different datasets can be compared using the same legend. This can be
easily done by setting <code>norm_lgd</code> to <code>TRUE</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Nomalise the legend</span></span>
<span><span class="va">normalised_lgd</span>       <span class="op">=</span> <span class="fu"><a href="../reference/hhm.html">hhm</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">example_migration</span>,</span>
<span>                           ylower <span class="op">=</span> <span class="st">"Origin County"</span>,</span>
<span>                           xlower <span class="op">=</span> <span class="st">"Destination County"</span>,</span>
<span>                           yupper <span class="op">=</span> <span class="st">"Origin Region"</span>,</span>
<span>                           xupper <span class="op">=</span> <span class="st">"Destination Region"</span>,</span>
<span>                           values <span class="op">=</span> <span class="st">"Migration"</span>,</span>
<span>                           yttl_width <span class="op">=</span> <span class="fl">0.22</span>,</span>
<span>                           xttl_height <span class="op">=</span> <span class="fl">0.22</span>,</span>
<span>                           rm_diag <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                           norm_lgd <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View result</span></span>
<span><span class="va">normalised_lgd</span></span></code></pre></div>
<p><img src="hhmR_overview_files/figure-html/unnamed-chunk-7-1.png" width="686.4"></p>
</div>
<div class="section level4">
<h4 id="manually-define-continuous-colour-scheme">Manually define continuous colour scheme<a class="anchor" aria-label="anchor" href="#manually-define-continuous-colour-scheme"></a>
</h4>
<p>The default colour scheme fades from blue to white. However, the
legend colour scheme can be define manually by passing a vector of
hexcodes to the argument <code>cclrs</code>. In this example, the
viridis colour scheme has been provided.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Manually define colour scheme for heatmap (uses viridis colour scheme)</span></span>
<span><span class="va">viridis_12</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#440154FF"</span>,<span class="st">"#482173FF"</span>,<span class="st">"#433E85FF"</span>,<span class="st">"#38598CFF"</span>,<span class="st">"#2D708EFF"</span>,<span class="st">"#25858EFF"</span>,</span>
<span>               <span class="st">"#1E9B8AFF"</span>,<span class="st">"#2BB07FFF"</span>,<span class="st">"#51C56AFF"</span>,<span class="st">"#85D54AFF"</span>,<span class="st">"#C2DF23FF"</span>,<span class="st">"#FDE725FF"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Assign continuous colour scheme</span></span>
<span><span class="va">cont_clrs</span>            <span class="op">=</span> <span class="fu"><a href="../reference/hhm.html">hhm</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">example_migration</span>,</span>
<span>                           ylower <span class="op">=</span> <span class="st">"Origin County"</span>,</span>
<span>                           xlower <span class="op">=</span> <span class="st">"Destination County"</span>,</span>
<span>                           yupper <span class="op">=</span> <span class="st">"Origin Region"</span>,</span>
<span>                           xupper <span class="op">=</span> <span class="st">"Destination Region"</span>,</span>
<span>                           values <span class="op">=</span> <span class="st">"Migration"</span>,</span>
<span>                           yttl_width <span class="op">=</span> <span class="fl">0.22</span>,</span>
<span>                           xttl_height <span class="op">=</span> <span class="fl">0.22</span>,</span>
<span>                           rm_diag <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                           norm_lgd <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                           cclrs <span class="op">=</span> <span class="va">viridis_12</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View result</span></span>
<span><span class="va">cont_clrs</span></span></code></pre></div>
<p><img src="hhmR_overview_files/figure-html/unnamed-chunk-8-1.png" width="686.4"></p>
</div>
<div class="section level4">
<h4 id="break-data-into-equal-interval-bins">Break data into equal interval bins<a class="anchor" aria-label="anchor" href="#break-data-into-equal-interval-bins"></a>
</h4>
<p>The function also contains the option to break the data into a
specified number categories, based on equal interval breaks between 0
and the maximum value within the dataset. This can be done by passing
the number of desired categories to <code>bins</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Break legends into a specified number of bins</span></span>
<span><span class="co"># (of equal intervals between 0 and the maximum value in `values`)</span></span>
<span><span class="va">bins_15</span>              <span class="op">=</span> <span class="fu"><a href="../reference/hhm.html">hhm</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">example_migration</span>,</span>
<span>                           ylower <span class="op">=</span> <span class="st">"Origin County"</span>,</span>
<span>                           xlower <span class="op">=</span> <span class="st">"Destination County"</span>,</span>
<span>                           yupper <span class="op">=</span> <span class="st">"Origin Region"</span>,</span>
<span>                           xupper <span class="op">=</span> <span class="st">"Destination Region"</span>,</span>
<span>                           values <span class="op">=</span> <span class="st">"Migration"</span>,</span>
<span>                           yttl_width <span class="op">=</span> <span class="fl">0.22</span>,</span>
<span>                           xttl_height <span class="op">=</span> <span class="fl">0.22</span>,</span>
<span>                           rm_diag <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                           bins <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View result</span></span>
<span><span class="va">bins_15</span></span></code></pre></div>
<p><img src="hhmR_overview_files/figure-html/unnamed-chunk-9-1.png" width="686.4"></p>
</div>
<div class="section level4">
<h4 id="manually-define-interval-breaks">Manually define interval breaks<a class="anchor" aria-label="anchor" href="#manually-define-interval-breaks"></a>
</h4>
<p>At times it might be desirable to manually define the intervals
breaks between categories. For example, if the data is highly skewed or
normally distributed then equal interval breaks may be inappropriate.
Manual breaks can be provided by passing a vector of intervals to
<code>cbrks</code>. In this instance, the <code>hhmR</code> function
<code>log_seq</code> has been used to create a vector of logarithmically
increasing values between 1 and the maximum value in the dataset (not on
the diagonal).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Manually break data into categories using user-specified intervals.</span></span>
<span><span class="va">cbrks</span> <span class="op">=</span> <span class="fu"><a href="../reference/log_seq.html">log_seq</a></span><span class="op">(</span><span class="va">example_migration</span><span class="op">[</span><span class="va">example_migration</span><span class="op">[[</span><span class="st">"Origin County"</span>     <span class="op">]</span><span class="op">]</span> <span class="op">!=</span></span>
<span>                                  <span class="va">example_migration</span><span class="op">[[</span><span class="st">"Destination County"</span><span class="op">]</span><span class="op">]</span>,<span class="op">]</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>                <span class="va">.</span><span class="op">$</span><span class="va">Migration</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="op">)</span>, <span class="fl">12</span>, rmv_extremes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Show interval breaks</span></span>
<span><span class="va">cbrks</span></span>
<span><span class="co">#&gt;  [1]  1  2  4  6  8 11 14 19 25 35</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Manually assign legend categories</span></span>
<span><span class="va">legend_cats</span>          <span class="op">=</span> <span class="fu"><a href="../reference/hhm.html">hhm</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">example_migration</span>,</span>
<span>                           ylower <span class="op">=</span> <span class="st">"Origin County"</span>,</span>
<span>                           xlower <span class="op">=</span> <span class="st">"Destination County"</span>,</span>
<span>                           yupper <span class="op">=</span> <span class="st">"Origin Region"</span>,</span>
<span>                           xupper <span class="op">=</span> <span class="st">"Destination Region"</span>,</span>
<span>                           values <span class="op">=</span> <span class="st">"Migration"</span>,</span>
<span>                           yttl_width <span class="op">=</span> <span class="fl">0.22</span>,</span>
<span>                           xttl_height <span class="op">=</span> <span class="fl">0.22</span>,</span>
<span>                           rm_diag <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                           cbrks <span class="op">=</span> <span class="va">cbrks</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View result</span></span>
<span><span class="va">legend_cats</span></span></code></pre></div>
<p><img src="hhmR_overview_files/figure-html/unnamed-chunk-11-1.png" width="686.4"></p>
</div>
<div class="section level4">
<h4 id="manually-assign-categoric-colours">Manually assign categoric colours<a class="anchor" aria-label="anchor" href="#manually-assign-categoric-colours"></a>
</h4>
<p>It is also possible to manually define the colour of each category by
passing a vector of hexcodes to <code>cclrs</code>. The length of this
vector must be two longer then the vector passed to
<code>cbrks</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Manually assign colours to legend categories</span></span>
<span><span class="va">cat_clrs</span>             <span class="op">=</span> <span class="fu"><a href="../reference/hhm.html">hhm</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">example_migration</span>,</span>
<span>                           ylower <span class="op">=</span> <span class="st">"Origin County"</span>,</span>
<span>                           xlower <span class="op">=</span> <span class="st">"Destination County"</span>,</span>
<span>                           yupper <span class="op">=</span> <span class="st">"Origin Region"</span>,</span>
<span>                           xupper <span class="op">=</span> <span class="st">"Destination Region"</span>,</span>
<span>                           values <span class="op">=</span> <span class="st">"Migration"</span>,</span>
<span>                           yttl_width <span class="op">=</span> <span class="fl">0.22</span>,</span>
<span>                           xttl_height <span class="op">=</span> <span class="fl">0.22</span>,</span>
<span>                           rm_diag <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                           cbrks <span class="op">=</span> <span class="va">cbrks</span>,</span>
<span>                           cclrs <span class="op">=</span> <span class="va">viridis_12</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View result</span></span>
<span><span class="va">cat_clrs</span></span></code></pre></div>
<p><img src="hhmR_overview_files/figure-html/unnamed-chunk-12-1.png" width="686.4"></p>
<p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="time-series-heatmaps-tshhm">Time-series heatmaps (<code>tshhm</code>)<a class="anchor" aria-label="anchor" href="#time-series-heatmaps-tshhm"></a>
</h2>
<p>Another common challenge with hierarchical data is visualising how it
changes over time. The function <code>tshhm</code> is design to address
this. This function is useful if you wish to create a time-series
heatmap where the categories shown on the y axis can be grouped in some
way. This heatmap will order the categories by their assigned group and
present both the categories and group labels along the y-axis.</p>
<p>To illustrate this, we use immigration data between 2011-2015 for the
same fake country as the previous example
(<code>example_time_series</code>). This country is made up of the same
regions, with each region containing the same counties as shown. It
contains four columns: a <code>County</code> (and the
<code>Region</code> it is within), the <code>Year</code> of observation,
and the number of immigrants a county recieved in a given year
(<code>Immigration</code>).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Show data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">example_time_series</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">#&gt;   Region County      Year Immigration</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> North  Greenridge  <span style="text-decoration: underline;">2</span>011        <span style="text-decoration: underline;">7</span>452</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> North  Greenridge  <span style="text-decoration: underline;">2</span>012          <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> North  Greenridge  <span style="text-decoration: underline;">2</span>013         298</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> North  Greenridge  <span style="text-decoration: underline;">2</span>014        <span style="text-decoration: underline;">8</span>800</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> North  Greenridge  <span style="text-decoration: underline;">2</span>015        <span style="text-decoration: underline;">4</span>265</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> North  Windermoor  <span style="text-decoration: underline;">2</span>011        <span style="text-decoration: underline;">8</span>016</span></span></code></pre></div>
<div class="section level4">
<h4 id="initial-heatmap-1">Initial Heatmap<a class="anchor" aria-label="anchor" href="#initial-heatmap-1"></a>
</h4>
<p>To run the function, the variable <code>County</code> is provided as
the lower-level categories (<code>lower</code>) to be shown along the
y-axis, while the variable <code>Region</code> is provided as the
upper-level groups (<code>upper</code>) with which to order and group
the heatmap rows. Additionally, <code>Year</code> is provided as the
time intervals to be shown on along the axis (<code>times</code>), while
<code>Immigration</code> provides the values with which to populate the
heatmap (<code>values</code>). Finally, <code>yttl_width</code> and is
used to ensure there is enough space for the region names to be shown
correctly on the y-axis. Note that NA values are displayed as blank.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Intial heatmap</span></span>
<span><span class="va">time_series_heatmap</span> <span class="op">=</span> <span class="fu"><a href="../reference/tshhm.html">tshhm</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">example_time_series</span>,</span>
<span>                            lower  <span class="op">=</span> <span class="st">"County"</span>,</span>
<span>                            upper  <span class="op">=</span> <span class="st">"Region"</span>,</span>
<span>                            times  <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>                            values <span class="op">=</span> <span class="st">"Immigration"</span>,</span>
<span>                            yttl_width  <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View result</span></span>
<span><span class="va">time_series_heatmap</span></span></code></pre></div>
<p><img src="hhmR_overview_files/figure-html/unnamed-chunk-14-1.png" width="686.4"></p>
</div>
<div class="section level4">
<h4 id="sort-rows-in-ascending-order">Sort rows in ascending order<a class="anchor" aria-label="anchor" href="#sort-rows-in-ascending-order"></a>
</h4>
<p>It can sometimes be useful to arrange rows in ascending or descending
order, depending on the values within the heatmap. The parameter
<code>sum_ascend</code> allows for this functionality by arranging the
rows within in group. The default option is <code>alphabetical</code>,
which orders rows in alphabetical order from top to bottom. Other
options include <code>sum_ascend</code> and <code>mean_ascend</code>,
which order rows in ascending order (top to bottom) based on the row
totals and row means respectively. This order can be reversed with the
options <code>sum_descend</code> and <code>mean_descend</code>. Manually
defining the order of upper-level groups (<code>Region</code> in this
example) is demonstrated at the end of the vignette.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Arrange counties within each region by total number of immigrants</span></span>
<span><span class="co"># across all five years (ascending from top to bottom)</span></span>
<span><span class="va">sort_ascending</span>      <span class="op">=</span> <span class="fu"><a href="../reference/tshhm.html">tshhm</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">example_time_series</span>,</span>
<span>                            lower  <span class="op">=</span> <span class="st">"County"</span>,</span>
<span>                            upper  <span class="op">=</span> <span class="st">"Region"</span>,</span>
<span>                            times  <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>                            values <span class="op">=</span> <span class="st">"Immigration"</span>,</span>
<span>                            sort_lower <span class="op">=</span> <span class="st">"sum_ascend"</span>,</span>
<span>                            yttl_width  <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View result</span></span>
<span><span class="va">sort_ascending</span></span></code></pre></div>
<p><img src="hhmR_overview_files/figure-html/unnamed-chunk-15-1.png" width="686.4"></p>
</div>
<div class="section level4">
<h4 id="normalise-legend-1">Normalise legend<a class="anchor" aria-label="anchor" href="#normalise-legend-1"></a>
</h4>
<p>Sometimes it can be useful to normalise the values within a heatmap,
so different datasets can be compared using the same legend. This can be
easily done by setting <code>norm_lgd</code> to <code>TRUE</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Nomalise the legend</span></span>
<span><span class="va">normalised_lgd</span>      <span class="op">=</span> <span class="fu"><a href="../reference/tshhm.html">tshhm</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">example_time_series</span>,</span>
<span>                            lower  <span class="op">=</span> <span class="st">"County"</span>,</span>
<span>                            upper  <span class="op">=</span> <span class="st">"Region"</span>,</span>
<span>                            times  <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>                            values <span class="op">=</span> <span class="st">"Immigration"</span>,</span>
<span>                            sort_lower <span class="op">=</span> <span class="st">"sum_ascend"</span>,</span>
<span>                            norm_lgd <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                            yttl_width  <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View result</span></span>
<span><span class="va">normalised_lgd</span></span></code></pre></div>
<p><img src="hhmR_overview_files/figure-html/unnamed-chunk-16-1.png" width="686.4"></p>
</div>
<div class="section level4">
<h4 id="manually-define-continuous-colour-scheme-1">Manually define continuous colour scheme<a class="anchor" aria-label="anchor" href="#manually-define-continuous-colour-scheme-1"></a>
</h4>
<p>The legend colour scheme can be defined manually by passing a vector
of hexcodes to the argument <code>cclrs</code>. In this example, the
viridis colour scheme has been provided.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Assign continuous colour scheme</span></span>
<span><span class="va">cont_clrs</span>           <span class="op">=</span> <span class="fu"><a href="../reference/tshhm.html">tshhm</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">example_time_series</span>,</span>
<span>                            lower  <span class="op">=</span> <span class="st">"County"</span>,</span>
<span>                            upper  <span class="op">=</span> <span class="st">"Region"</span>,</span>
<span>                            times  <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>                            values <span class="op">=</span> <span class="st">"Immigration"</span>,</span>
<span>                            sort_lower <span class="op">=</span> <span class="st">"sum_ascend"</span>,</span>
<span>                            norm_lgd <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                            cclrs <span class="op">=</span> <span class="va">viridis_12</span>,</span>
<span>                            yttl_width  <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View result</span></span>
<span><span class="va">cont_clrs</span></span></code></pre></div>
<p><img src="hhmR_overview_files/figure-html/unnamed-chunk-17-1.png" width="686.4"></p>
</div>
<div class="section level4">
<h4 id="assign-na-colours">Assign NA colours<a class="anchor" aria-label="anchor" href="#assign-na-colours"></a>
</h4>
<p>It can sometimes be useful to visually highlight cells where data is
missing. This can be done by passing a hexcode to the argument
<code>na_colour</code>. This will cause all NA values within the dataset
to be displayed in the specified colour.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Assign colour for NA values</span></span>
<span><span class="va">na_clrs</span>             <span class="op">=</span> <span class="fu"><a href="../reference/tshhm.html">tshhm</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">example_time_series</span>,</span>
<span>                            lower  <span class="op">=</span> <span class="st">"County"</span>,</span>
<span>                            upper  <span class="op">=</span> <span class="st">"Region"</span>,</span>
<span>                            times  <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>                            values <span class="op">=</span> <span class="st">"Immigration"</span>,</span>
<span>                            sort_lower <span class="op">=</span> <span class="st">"sum_ascend"</span>,</span>
<span>                            norm_lgd <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                            cclrs <span class="op">=</span> <span class="va">viridis_12</span>,</span>
<span>                            na_colour <span class="op">=</span> <span class="st">"grey80"</span>,</span>
<span>                            yttl_width  <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View result</span></span>
<span><span class="va">na_clrs</span></span></code></pre></div>
<p><img src="hhmR_overview_files/figure-html/unnamed-chunk-18-1.png" width="686.4"></p>
</div>
<div class="section level4">
<h4 id="break-data-into-equal-interval-bins-1">Break data into equal interval bins<a class="anchor" aria-label="anchor" href="#break-data-into-equal-interval-bins-1"></a>
</h4>
<p>The function also contains the option to break the data into a
specified number categories, based on equal interval breaks between 0
and the maximum value within the dataset. This can be done by passing
the number of desired categories to <code>bins</code>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Break legends into a specified number of bins</span></span>
<span><span class="co"># (of equal intervals between 0 and the maximum value in `values`)</span></span>
<span><span class="va">bins_15</span>             <span class="op">=</span> <span class="fu"><a href="../reference/tshhm.html">tshhm</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">example_time_series</span>,</span>
<span>                            lower  <span class="op">=</span> <span class="st">"County"</span>,</span>
<span>                            upper  <span class="op">=</span> <span class="st">"Region"</span>,</span>
<span>                            times  <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>                            values <span class="op">=</span> <span class="st">"Immigration"</span>,</span>
<span>                            sort_lower <span class="op">=</span> <span class="st">"sum_ascend"</span>,</span>
<span>                            bins <span class="op">=</span> <span class="fl">15</span>,</span>
<span>                            yttl_width  <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View result</span></span>
<span><span class="va">bins_15</span></span></code></pre></div>
<p><img src="hhmR_overview_files/figure-html/unnamed-chunk-19-1.png" width="686.4"></p>
</div>
<div class="section level4">
<h4 id="manually-define-interval-breaks-1">Manually define interval breaks<a class="anchor" aria-label="anchor" href="#manually-define-interval-breaks-1"></a>
</h4>
<p>At times it might be desirable to manually define the intervals
breaks between categories. For example, if the data is highly skewed or
normally distributed then equal interval breaks may be inappropriate.
Manual breaks can be provided by passing a vector of intervals to
<code>cbrks</code>. In this instance, the <code>hhmR</code> function
<code>log_seq</code> has been used to create a vector of logarithmically
increasing values between 1 and the maximum value in the dataset.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Manually break data into categories using user-specified intervals.</span></span>
<span><span class="va">cbrks</span> <span class="op">=</span> <span class="fu"><a href="../reference/log_seq.html">log_seq</a></span><span class="op">(</span><span class="va">example_time_series</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="va">.</span><span class="op">$</span><span class="va">Immigration</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                <span class="fl">12</span>, rmv_extremes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Show breaks</span></span>
<span><span class="va">cbrks</span></span>
<span><span class="co">#&gt;  [1]    1  113  239  382  548  743  982 1291 1725 2468</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Manually assign legend categories</span></span>
<span><span class="va">legend_cats</span>         <span class="op">=</span> <span class="fu"><a href="../reference/tshhm.html">tshhm</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">example_time_series</span>,</span>
<span>                            lower  <span class="op">=</span> <span class="st">"County"</span>,</span>
<span>                            upper  <span class="op">=</span> <span class="st">"Region"</span>,</span>
<span>                            times  <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>                            values <span class="op">=</span> <span class="st">"Immigration"</span>,</span>
<span>                            sort_lower <span class="op">=</span> <span class="st">"sum_ascend"</span>,</span>
<span>                            cbrks <span class="op">=</span> <span class="va">cbrks</span>,</span>
<span>                            yttl_width  <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View result</span></span>
<span><span class="va">legend_cats</span></span></code></pre></div>
<p><img src="hhmR_overview_files/figure-html/unnamed-chunk-21-1.png" width="686.4"></p>
</div>
<div class="section level4">
<h4 id="manually-assign-categoric-colours-1">Manually assign categoric colours<a class="anchor" aria-label="anchor" href="#manually-assign-categoric-colours-1"></a>
</h4>
<p>It is also possible to manually define the colour of each category by
passing a vector of hexcodes to <code>cclrs</code>. The length of this
vector must be two longer then the vector passed to
<code>cbrks</code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Manually assign colours to legend categories</span></span>
<span><span class="va">cat_clrs</span>            <span class="op">=</span> <span class="fu"><a href="../reference/tshhm.html">tshhm</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">example_time_series</span>,</span>
<span>                            lower  <span class="op">=</span> <span class="st">"County"</span>,</span>
<span>                            upper  <span class="op">=</span> <span class="st">"Region"</span>,</span>
<span>                            times  <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>                            values <span class="op">=</span> <span class="st">"Immigration"</span>,</span>
<span>                            sort_lower <span class="op">=</span> <span class="st">"sum_ascend"</span>,</span>
<span>                            cbrks <span class="op">=</span> <span class="va">cbrks</span>,</span>
<span>                            cclrs <span class="op">=</span> <span class="va">viridis_12</span>,</span>
<span>                            na_colour <span class="op">=</span> <span class="st">"grey80"</span>,</span>
<span>                            yttl_width  <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View result</span></span>
<span><span class="va">cat_clrs</span></span></code></pre></div>
<p><img src="hhmR_overview_files/figure-html/unnamed-chunk-22-1.png" width="686.4"></p>
</div>
<div class="section level4">
<h4 id="manually-define-the-order-of-x-axis-values-and-y-axis-groups">Manually define the order of x-axis values and y-axis groups<a class="anchor" aria-label="anchor" href="#manually-define-the-order-of-x-axis-values-and-y-axis-groups"></a>
</h4>
<p>If the variable supplied to <code>times</code> is numeric, it will by
default sort values in ascending order from left to right along the
x-axis. However, this order can be manually changed by supplying a
factor to <code>times</code>. To demonstrate this, we have supplied the
variable <code>Year</code> as a factor with the years 2011-2015 ordered
non-chronologically.</p>
<p>Similarly, the groups supplied to <code>Upper</code> will by default
be displayed alphabetically from top to bottom along the y-axis.
However, this order can be manually changed by supplying a factor to
<code>upper</code>. In the below example, we have supplied the variable
<code>Region</code> with regions ordered from North-West to
South-East.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Manually define order of x-axis and groups using factor levels</span></span>
<span><span class="va">new_time_series</span> <span class="op">=</span> <span class="va">example_time_series</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>                  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Year   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Year</span>,</span>
<span>                                         levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2012</span>,<span class="fl">2011</span>,<span class="fl">2014</span>,</span>
<span>                                                    <span class="fl">2013</span>,<span class="fl">2015</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                         Region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Region</span>,</span>
<span>                                         levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"North"</span>,<span class="st">"Midlands"</span>,</span>
<span>                                                    <span class="st">"South West"</span>,</span>
<span>                                                    <span class="st">"South East"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Manually define order of x-axis and groups</span></span>
<span><span class="va">rearrange_axes</span>      <span class="op">=</span> <span class="fu"><a href="../reference/tshhm.html">tshhm</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">new_time_series</span>,</span>
<span>                            lower  <span class="op">=</span> <span class="st">"County"</span>,</span>
<span>                            upper  <span class="op">=</span> <span class="st">"Region"</span>,</span>
<span>                            times  <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>                            values <span class="op">=</span> <span class="st">"Immigration"</span>,</span>
<span>                            sort_lower <span class="op">=</span> <span class="st">"sum_ascend"</span>,</span>
<span>                            cbrks <span class="op">=</span> <span class="va">cbrks</span>,</span>
<span>                            cclrs <span class="op">=</span> <span class="va">viridis_12</span>,</span>
<span>                            na_colour <span class="op">=</span> <span class="st">"grey80"</span>,</span>
<span>                            yttl_width  <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View result</span></span>
<span><span class="va">rearrange_axes</span></span></code></pre></div>
<p><img src="hhmR_overview_files/figure-html/unnamed-chunk-23-1.png" width="686.4"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Michael Mahony, Francisco Rowe, Carmen Cabrera-Arnau.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
